# Aula 4 - Testando o frontend independente da API

Ã‰ importante que tenhamos alguns testes que interagem com a aplicaÃ§Ã£o _end-to-end_. PorÃ©m, vÃ¡rios outros testes poderiam ser muito mais rÃ¡pidos, independentes, e desacoplados, sem perdermos a garantia de que tudo funciona conforme o esperado. Afinal, ainda teremos alguns testes _end-to-end_.

AlÃ©m de podermos simular situaÃ§Ãµes de erro com o `cy.intercept()`, tambÃ©m podemos mockar a resposta devolvida pela API.

Escrevi os seguintes conteÃºdos a respeito do assunto, e recomendo a leitura antes de seguir adiante.

* [**Como interceptar e mockar a resposta de uma requisiÃ§Ã£o HTTP com Cypress**](https://talkingabouttesting.com/2021/02/15/como-interceptar-e-mockar-a-resposta-de-uma-requisicao-http-com-cypress/)
* [**Como utilizar fixtures com Cypress para isolar os testes do frontend**](https://talkingabouttesting.com/2021/02/16/como-utilizar-fixtures-com-cypress-para-isolar-os-testes-do-frontend/)

## ExercÃ­cio

Primeiro, vamos garantir que os seguintes cenÃ¡rios sÃ£o cobertos por testes _end-to-end_. Ou seja, nestes casos, a aplicaÃ§Ã£o se comunica com a API real.

* `shows 20 stories, then the next 20 after clicking "More"`
* `searches via the last searched term`

## Extra credit 1

Ok, agora que temos dois testes _end-to-end_, refatore os seguintes testes para mockar a resposta da API.

* `shows only nineteen stories after dimissing the first story` (neste teste, vocÃª pode mudar para quantas histÃ³rias vocÃª quiser, nÃ£o precisam ser necessarimamente 19)
* `types and hits ENTER`
* `types and clicks the submit button`
* `shows a max of 5 buttons for the last searched terms`

**Dica:** ğŸ§™â€â™‚ï¸ Recomendo separar os testes que interagem com a API real e os que Ã  mockam em contextos independentes.

> Gravei um vÃ­deo com a soluÃ§Ã£o para cada um dos testes acima, ou seja `extra-credit-4-1-1`, `extra-credit-4-1-2`, etc.

**Curiosidade**: _VocÃª percebeu a implementaÃ§Ã£o do teste `types and hits ENTER`, onde utilizo ``.type(`${newTerm}{enter}`)`` para digitar e logo apÃ³s pressionar ENTER? Interessante, nÃ£o? Se quiser saber mais a respeito, escrevi um conteÃºdo chamado [**como digitar e pressionar ENTER com Cypress**](https://talkingabouttesting.com/2021/03/01/como-digitar-e-pressionar-enter-com-cypress/)_.

## Extra credit 2

Show de bola! ğŸ€ Agora que estamos mockando a resposta da API em alguns testes, podemos utilizar esta abordagem para cobrir outros testes que ainda estÃ£o pendentes.

Implemente os seguintes testes:

* `shows the right data for all rendered stories`
* `orders by title`
* `orders by author`
* `orders by comments`
* `orders by points`
* `shows no story when none is returned` (este teste ainda nÃ£o exite, nem como pendente e vocÃª terÃ¡ que implementÃ¡-lo do zero)

> Gravei um vÃ­deo com a soluÃ§Ã£o para cada um dos testes acima, ou seja `extra-credit-4-2-1`, `extra-credit-4-2-2`, etc.

___

Ã“timo trabalho! ğŸ‘ğŸ½

VÃ¡ para a [aula 5](./5.md) e vamos refatorar os testes um pouco mais, para tornÃ¡-los ainda mais robustos e seguirmos outra boa prÃ¡tica.
